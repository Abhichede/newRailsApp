<%- model_class = Site -%>
<div class="page-header">
  <h3><%= 'All Sites'.upcase %>
    <span class="pull-right">
      <%= link_to 'Add Site',
                  new_site_path,
                  :class => 'btn btn-primary btn-sm' %>
    </span>
  </h3>
</div>

<div class="row">
<% @sites.each do |site| %>
 <div class="col-lg-4 col-md-4 col-sm-6 site-card" style="margin-top: 2rem; margin-bottom: 2rem;">
  <div class="card" style="width: 30rem;">
    <% if site.photo_path.blank? %>
        <%= image_tag 'Default-Home.jpg', class: 'img-responsive' %>
    <% else %>
        <%= image_tag site.photo_path.url, class: 'img-responsive' %>
    <% end  %>
    <div class="card-block text-center" style="padding: 2rem; overflow: hidden; height: 7rem">
      <h4 class="card-title"><strong><%= site.name.upcase %></strong></h4>
      <br/>
    </div>
    <div class="card-footer" style="padding: 1rem">
      <%= link_to 'Visit', site_path(site), class: 'btn btn-warning btn-sm btn-block' %>
    </div>
    <div class="card-data text-muted text-center">
      <% if site.site_type === "Residential+Commercial" || site.site_type === "Commercial" %>
          Booked Flats <span class="badge"> <%= (site.flats.where(:booking_status=>1).count - site.flats.where(:flat_type => 'SHOP', :booking_status => 1).count) %></span>
          Booked Shops <span class="badge"> <%= site.flats.where(:booking_status=>1, :flat_type => 'SHOP').count %></span>
      <% else %>
          Booked Flats <span class="badge"> <%= site.flats.where(:booking_status=>1).count %></span>
      <% end %>
    </div>
  </div>
 </div>
<% end %>
</div>

